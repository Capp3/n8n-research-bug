name: Code Quality

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install UV
        uses: astral-sh/setup-uv@v3
        with:
          version: 'latest'

      - name: Install dependencies
        run: |
          uv pip install --system PyYAML

      - name: Validate YAML files
        run: |
          echo "üîç Validating YAML files..."
          python -c "import yaml; yaml.safe_load(open('mkdocs.yml'))"
          for file in .github/workflows/*.yml; do
            echo "Validating $file"
            python -c "import yaml; yaml.safe_load(open('$file'))"
          done
          echo "‚úÖ All YAML files are valid"

      - name: Check documentation structure
        run: |
          echo "üîç Checking documentation structure..."
          test -f docs/index.md
          test -f docs/projectbrief.md
          test -f docs/technical.md
          test -d docs/creative
          test -d docs/implementation
          test -d docs/contributing
          test -d docs/status
          test -d docs/archive
          test -d docs/test-data
          echo "‚úÖ Documentation structure is valid"

      - name: Validate prompt templates
        run: |
          echo "üîç Validating prompt templates..."
          test -f prompts/index.json
          python -c "import json; json.load(open('prompts/index.json'))"
          echo "‚úÖ Prompt templates are valid"
